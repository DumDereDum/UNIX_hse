## Задание
```
Поднимите самбу(samba). Поднимите любой веб-сервер(nginx, apache, lighttpd, cherokee). 
пошарьте папку со страницами(или переназначьте веб сервер на пошаренную папку). 
Сделайте так чтобы вы могли коммитить в эту-же папку гитом.
Делайте бекап кода веб страниц в 05-00 каждый день, если день не дождливый. 
Учитывайте что бекап кода может быть поврежден если в момент бекапа кто-то пишет по самбе.
```

Я решил использовать Docker, чтобы не бояться что-то сломать на своей системе, потому что с докером не так страшно сделать ошибку нежели со своей системой.

## Запуск 

Для запуска нужно выполнить следующие команды:
```
docker build --tag unixhw:1.0 .
docker run --mount src="$(pwd)/data",target=/files,type=bind -p 8080:80 -p 445:445 unixhw:1.0
```

## Работа

При создании образа, директория configs копируется внутрь образа, устанавливается Samba и Git, так же перемещает конфигруационные файлы в соответствующие директории. 

При запуске записукается скрипт init.sh.

## Настройка

### 1.Samba

Установка Samba:
```
apt-get update && apt-get install -y samba
```
Настройка:
Создал простой и обычный конфигурационный файл и после поместил его в /etc/samba/smb.conf 

### 2.Веб-сервер

Запускается одной командой, используя python3
```
python3 -m http.server 80 --directory /files
```

### 3.Git

Для того чтобы коммитить в папку с Git'ом нужно только инициализировать в ней репозиторий. Эта инициализация прописана в скрипте, который запускается при старте контейнера.
```Shell
if ! [ -d /files/.git ]; then
	git init /files/
fi
```

### 4.Бекап

Написанные скрипт для бекапа использует данные с сайта wttr.in для получения погоды и tar для создания бекапов, котрые именуются с учетом текущей даты.

Для избежания проблем с перезаписью фалов, я останавливаю сервер Samba, отправляя SIGTSTP процессу сервера. А уже после выполнения бекапа процесс получает SIGCONT, чт возобновляет его работу.

## Пример

Вроде все заработало.

![alt text](https://raw.githubusercontent.com/DumDereDum/UNIX_hse/master/22.04.2020/src_img/work.png) 
